(function(f) {
    function g() {
        var q = getCookie("cokilocationcode");
        q = base64_decode(q);
        curr = window.location.href;
        var p = /\/$/;
        curr = curr.replace(p, "");
        root = rooturl_store.replace(p, "");
        var o = "";
        if (typeof(Storage) !== "undefined") {
            o = sessionStorage.getItem("svw")
        }
        if (q == "" || (q != "" && curr == root && o != q)) {
            var r = document.title;
            f.ajax({
                type: "POST",
                dataType: "json",
                data: {
                    samess: o
                },
                cache: false,
                url: rooturl_store + "generalrealtime/dglip",
                beforeSend: function() {
                    f(".cls_loader").css("display", "flex");
                    f(".noclick").show();
                    document.title = "Vascara"
                },
                error: function() {},
                success: function(s) {
                    if (s.link != "") {
                        window.location.replace(s.link)
                    } else {
                        f(".noclick").hide();
                        f(".cls_loader").css("display", "none");
                        document.title = r
                    }
                    if (typeof(Storage) !== "undefined") {
                        sessionStorage.setItem("svw", "vn")
                    }
                },
                complete: function() {
                    f(".cls_loader").css("display", "none")
                }
            })
        }
    }

    function m() {
        var s = getCookie("islogin");
        if (s == 1) {
            var v = true;
            if (typeof(Storage) !== "undefined") {
                var p = sessionStorage.getItem("un");
                var r = sessionStorage.getItem("uav");
                if (p != "" && p != null) {
                    v = false;
                    var q = rooturl_store + "templates/current/images/noavatar.png";
                    if (r != "" && r != null) {
                        q = r
                    }
                    var o = '<div class="logged">';
                    o += '<div class="avatar"><img src="' + q + '" alt="User Avatar"></div>';
                    o += '<div class="logged-menu">';
                    o += "<ul>";
                    o += "<li>Xin chào, " + p + "</li>";
                    o += '<li><a href="' + rooturl_store + 'profile">Thông tin tài khoản</a></li>';
                    o += '<li><a href="' + rooturl_store + 'logout">Đăng xuất</a></li>';
                    o += "</ul></div></div>";
                    f(".header-top .tool-right .profile").html(o);
                    var w = "<ul>";
                    w += "<li>Xin chào, " + p + "</li>";
                    w += '<li class="avatar"><img src="' + q + '" alt="User Avatar"></li></ul>';
                    f(".main-header .main-header-top .profile").html(w);
                    var u = "<ul>";
                    u += '<li><a href="' + rooturl_store + 'profile">Thông tin tài khoản</a></li>';
                    u += '<li><a href="' + rooturl_store + 'logout">Đăng xuất</a></li></ul>';
                    f(".main-header .main-header-bottom").html(u)
                }
            }
            if (v) {
                d()
            }
        }
    }

    function d() {
        f.ajax({
            type: "GET",
            dataType: "json",
            url: rooturl_store + "generalrealtime/checklogin",
            error: function() {},
            success: function(s) {
                if (s.rs) {
                    var r = "/templates/current/img/profile/thanhvien.png";
                    if (typeof(Storage) !== "undefined") {
                        var o = localStorage.getItem("uv");
                        if (o !== null && o > 0 && (o == 10 || o == 15)) {
                            if (o == 10) {
                                r = "/templates/current/img/profile/bac.png"
                            }
                            if (o == 15) {
                                r = "/templates/current/img/profile/vang.png"
                            }
                        }
                    }
                    var p = s.name.split(" ");
                    var u = '<div class="myaccounttoggle"><img src="' + r + '" style="width:25px" alt="vascara.com">Chào, ' + p[p.length - 1] + "</div>";
                    u += '<div class="list-login">';
                    u += '<ul class="login">';
                    u += '<li><a href="/profile">Thông tin tài khoản</a></li>';
                    u += '<li><a href="/logout">Đăng xuất</a></li>';
                    u += "</ul></div>";
                    f(".myaccount").html(u);
                    var p = s.name.split(" ");
                    var q = "Khách";
                    if (p[p.length - 1] != "") {
                        q = p[p.length - 1]
                    }
                    var w = rooturl_store + "templates/current/images/noavatar.png";
                    if (s.avatar != "") {
                        w = s.avatar
                    }
                    var z = '<div class="logged">';
                    z += '<div class="avatar"><img src="' + w + '" alt="User Avatar"></div>';
                    z += '<div class="logged-menu">';
                    z += "<ul>";
                    z += "<li>Xin chào, " + q + "</li>";
                    z += '<li><a href="' + rooturl_store + 'profile">Thông tin tài khoản</a></li>';
                    z += '<li><a href="' + rooturl_store + 'logout">Đăng xuất</a></li>';
                    z += "</ul></div></div>";
                    f(".header-top .tool-right .profile").html(z);
                    var A = "<ul>";
                    A += "<li>Xin chào, " + q + "</li>";
                    A += '<li class="avatar"><img src="' + w + '" alt="User Avatar"></li></ul>';
                    f(".main-header .main-header-top .profile").html(A);
                    var y = "<ul>";
                    y += '<li><a href="' + rooturl_store + 'profile">Thông tin tài khoản</a></li>';
                    y += '<li><a href="' + rooturl_store + 'logout">Đăng xuất</a></li></ul>';
                    f(".main-header .main-header-bottom").html(y);
                    if (typeof(Storage) !== "undefined") {
                        sessionStorage.setItem("un", q);
                        sessionStorage.setItem("uav", w)
                    }
                } else {
                    setCookie("islogin", 1, -30);
                    if (typeof(Storage) !== "undefined") {
                        localStorage.removeItem("uv", 0)
                    }
                    var u = '<div class="myaccounttoggle"><img src="/templates/current/img/n-icon/user.png" alt="vascara.com">Đăng nhập</div>';
                    u += '<div class="list-login">';
                    u += '<ul class="login">';
                    u += '<li><a href="/login">Đăng nhập</a></li>';
                    u += '<li><a href="/register">Tạo tài khoản</a></li>';
                    u += "</ul></div>";
                    f(".myaccount").html(u);
                    var v = '<div class="loggin">';
                    v += "<ul>";
                    v += '<li><a href="' + rooturl_store + 'register">ĐĂNG KÝ</a></li>';
                    v += '<li><a href="' + rooturl_store + 'login">ĐĂNG NHẬP</a></li>';
                    v += "</ul></div>";
                    f(".header-top .tool-right .profile").html(v);
                    var t = "<ul>";
                    t += '<li><a href="' + rooturl_store + 'register">Đăng ký</a></li>';
                    t += '<li><a href="' + rooturl_store + 'login">Đăng nhập</a></li></ul>';
                    f(".main-header .main-header-bottom").html(t);
                    var w = rooturl_store + "templates/current/images/noavatar.png";
                    var A = "<ul>";
                    A += '<li class="avatar"><img src="' + w + '" alt="User Avatar"></li></ul>';
                    f(".main-header .main-header-top .profile").html(A)
                }
            }
        })
    }

    function e() {
        var o = getCookie("ctiic");
        if (o == "") {
            f.ajax({
                type: "GET",
                dataType: "json",
                url: rooturl_store + "cart/gettotalitemincart",
                error: function() {},
                success: function(q) {
                    f(".cart .carttoggle span").text(q.total);
                    f(".cart span.count").text("(" + q.total + ")")
                }
            })
        } else {
            var p = base64_decode(o);
            if (p !== false) {
                f(".cart .carttoggle span").text(p);
                f(".cart span.count").text("(" + p + ")")
            }
        }
    }

    function h() {
        f(".btnwl-confirm").click(function() {
            var o = f("#hd-warehouse-location").val();
            f.ajax({
                type: "POST",
                dataType: "json",
                data: {
                    fwlocation: o
                },
                url: rooturl_store + "generalrealtime/changewarehouselocation",
                error: function() {},
                success: function(p) {
                    location.reload(true)
                }
            })
        })
    }

    function n() {
        var p = 1;
        var o = getCookie("fwlc");
        if (o == "") {
            f.ajax({
                type: "GET",
                dataType: "json",
                url: rooturl_store + "generalrealtime/warehouselocation",
                error: function() {},
                success: function(s) {
                    if (s.succ) {
                        a();
                        f("#hd-warehouse-location option[value='" + s.wl + "']").attr("selected", "selected");
                        var t = f("#hd-warehouse-location option:selected").text();
                        f(".hdwlname").text(t)
                    }
                    if (s.show == 1) {
                        f(".popup-loca").addClass("show-popup")
                    }
                    p = s.wl;
                    f("#hd-warehouse-location").select2({
                        minimumResultsForSearch: -1
                    }).select2("val", p.toString())
                }
            })
        } else {
            var q = base64_decode(o);
            if (q !== false) {
                a();
                f("#hd-warehouse-location option[value='" + q + "']").attr("selected", "selected");
                var r = f("#hd-warehouse-location option:selected").text();
                f(".hdwlname").text(r);
                f("#hd-warehouse-location").select2({
                    minimumResultsForSearch: -1
                }).select2("val", q)
            } else {
                f.ajax({
                    type: "GET",
                    dataType: "json",
                    url: rooturl_store + "generalrealtime/warehouselocation",
                    error: function() {},
                    success: function(s) {
                        if (s.succ) {
                            a();
                            f("#hd-warehouse-location option[value='" + s.wl + "']").attr("selected", "selected");
                            var t = f("#hd-warehouse-location option:selected").text();
                            f(".hdwlname").text(t)
                        }
                        if (s.show == 1) {
                            f(".popup-loca").addClass("show-popup")
                        }
                        p = s.wl;
                        f("#hd-warehouse-location").select2({
                            minimumResultsForSearch: -1
                        }).select2("val", p.toString())
                    }
                })
            }
        }
    }

    function a() {
        f("#hd-warehouse-location > option").each(function() {
            f(this).prop("selected", false)
        })
    }

    function c() {
        f.ajax({
            type: "GET",
            dataType: "json",
            url: rooturl_store + "generalrealtime/getLocation",
            error: function() {},
            success: function(o) {
                html = "";
                if (o.show == 1) {
                    f(".popup-loca-sale").addClass("show-popup")
                }
                f.each(o.data, function(p, q) {
                    html += '<option value="' + q.id + '">' + q.name + "</option>"
                });
                f(".popup-loca-sale .select-area").html(html);
                f(".popup-loca-sale .select-area").prop("disabled", false)
            }
        })
    }

    function b() {
        f(".btn-smit").click(function() {
            var o = f(".popup-loca-sale .select-area").val();
            if (o > 0) {
                f.ajax({
                    type: "POST",
                    dataType: "json",
                    data: {
                        flocation: o
                    },
                    url: rooturl_store + "generalrealtime/redirectLocation",
                    error: function() {},
                    success: function(p) {
                        if (p.succ == 1) {
                            window.location.href = rooturl_store + "uu-dai-dac-biet-20"
                        } else {
                            window.location.href = rooturl_store + "vascara-sale-off"
                        }
                    }
                })
            }
        })
    }

    function l() {
        var o = getCookie("localreg");
        o = base64_decode(o);
        if (o == "") {
            f.ajax({
                type: "GET",
                dataType: "json",
                url: rooturl_store + "generalrealtime/localreg",
                error: function() {},
                success: function(p) {}
            })
        }
    }
    f(function() {
        g();
        m();
        e();
        showVipPrice();
        h();
        n();
        b()
    })
})(jQuery);

function showVipPrice() {
    if (typeof(Storage) !== "undefined") {
        var a = localStorage.getItem("uv");
        if (a !== null && a > 0 && (a == 10 || a == 15)) {}
    }
}

function checkvip() {
    $.ajax({
        type: "GET",
        dataType: "json",
        url: rooturl_store + "generalrealtime/checkvip",
        error: function() {},
        success: function(a) {
            if (a.code > 0) {
                if ($("body .showvipprice").length > 0) {
                    $("body .showvipprice").each(function() {
                        var d = $(this).html();
                        var c = $(this).attr("data-price");
                        var b = $(this).attr("data-type");
                        if (d == "" && b == 1) {
                            $(this).html("Giá " + a.title + " : " + formatNumber(c * (100 - a.code) / 100) + " VND")
                        }
                    })
                }
            }
        }
    })
}

function formatNumber(b) {
    numberTemp = b;
    b = b.toFixed(2) + "";
    x = b.split(".");
    x1 = x[0];
    x2 = x.length > 1 ? "." + x[1] : "";
    var a = /(\d+)(\d{3})/;
    while (a.test(x1)) {
        x1 = x1.replace(a, "$1.$2")
    }
    return x1
}
if (navigator.cookieEnabled) {
    function setCookie(b, f, c) {
        if (!c) {
            c = 365
        }
        var e = new Date();
        e.setTime(e.getTime() + (c * 24 * 60 * 60 * 1000));
        var a = "expires=" + e.toUTCString();
        document.cookie = b + "=" + f + ";" + a + ";path=/"
    }

    function getCookie(d) {
        var b = d + "=";
        var a = document.cookie.split(";");
        for (var e = 0; e < a.length; e++) {
            var f = a[e];
            while (f.charAt(0) == " ") {
                f = f.substring(1)
            }
            if (f.indexOf(b) == 0) {
                return f.substring(b.length, f.length)
            }
        }
        return ""
    }

    function base64_encode(a) {
        return window.btoa(unescape(encodeURIComponent(a)))
    }

    function base64_decode(a) {
        a = a.split("%3D").join("=");
        try {
            return decodeURIComponent(escape(window.atob(a)))
        } catch (b) {
            return false
        }
    }
    var urlParams = new URLSearchParams(window.location.search);
    var utm = urlParams.get("utm_source");
    var utmm = urlParams.get("utm_medium");
    var utmid = urlParams.get("click_id");
    var trafficid = urlParams.get("traffic_id");
    var traffsid = urlParams.get("aff_sid");
    var fbclid = urlParams.has("fbclid");
    var getfbclid = urlParams.get("fbclid");
    var hasMedium = typeof utmm !== "undefined" && utmm !== null;
    var expiresin30 = 30;
    var expiresin7 = 7;
    var utmCases = [{
        utmValue: "talent",
        mediums: [{
            medium: utmm,
            cookieName: "utmtalent",
            cookieValue: utmid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "cityads",
        mediums: [{
            medium: utmm,
            cookieName: "utmcityads",
            cookieValue: utmid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "ecomobi",
        mediums: [{
            medium: utmm,
            cookieName: "ecomobi",
            cookieValue: trafficid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "masoffer",
        mediums: [{
            medium: utmm,
            cookieName: "masoffer",
            cookieValue: trafficid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "cs_ecom",
        mediums: [{
            medium: utmm,
            cookieName: "cs_ecom",
            cookieValue: trafficid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "accesstrade",
        mediums: [{
            medium: utmm,
            cookieName: "accesstrade",
            cookieValue: traffsid,
            expiresin: expiresin30
        }]
    }, {
        utmValue: "ecom",
        mediums: [{
            medium: "fb-ads",
            cookieName: "ecom",
            cookieValue: "FB-ADS",
            expiresin: expiresin7
        }, {
            medium: "zns",
            cookieName: "ecom",
            cookieValue: "ZNS",
            expiresin: expiresin7
        }, {
            medium: "sms",
            cookieName: "ecom",
            cookieValue: "SMS",
            expiresin: expiresin7
        }, {
            medium: "gdn",
            cookieName: "ecom",
            cookieValue: "GDN",
            expiresin: expiresin7
        }, {
            medium: "email",
            cookieName: "ecom",
            cookieValue: "EMAIL",
            expiresin: expiresin7
        }, {
            medium: "tiktok-ads",
            cookieName: "ecom",
            cookieValue: "TIKTOK-ADS",
            expiresin: expiresin7
        }, {
            medium: "performance-max",
            cookieName: "ecom",
            cookieValue: "PERFORMANCE-MAX",
            expiresin: expiresin7
        }]
    }, {
        utmValue: "trade",
        mediums: [{
            medium: "fb-ads",
            cookieName: "trade",
            cookieValue: "FB-ADS",
            expiresin: expiresin7
        }, {
            medium: "zns",
            cookieName: "trade",
            cookieValue: "ZNS",
            expiresin: expiresin7
        }, {
            medium: "sms",
            cookieName: "trade",
            cookieValue: "SMS",
            expiresin: expiresin7
        }, {
            medium: "gdn",
            cookieName: "trade",
            cookieValue: "GDN",
            expiresin: expiresin7
        }, {
            medium: "email",
            cookieName: "trade",
            cookieValue: "EMAIL",
            expiresin: expiresin7
        }, {
            medium: "tiktok-ads",
            cookieName: "trade",
            cookieValue: "TIKTOK-ADS",
            expiresin: expiresin7
        }]
    }, {
        utmValue: "fbclid",
        mediums: [{
            medium: "fbclid",
            cookieName: "fbclid",
            cookieValue: getfbclid,
            expiresin: expiresin7
        }, ]
    }, {
        utmValue: "fb-store",
        mediums: [{
            medium: "fbclid",
            cookieName: "fb-store",
            cookieValue: "fb-store",
            expiresin: expiresin7
        }, ]
    }, {
        utmValue: "zalo",
        mediums: [{
            medium: "zalo",
            cookieName: "zalo",
            cookieValue: "ZNS-ORGANIC",
            expiresin: expiresin7
        }, ]
    }, ];
    var cookiesToDelete = ["utmtalent", "utmcityads", "ecomobi", "masoffer", "cs_ecom", "accesstrade", "ecom", "trade", "zalo", "fbclid", "fb-store"];
    var fbclidCase = utmCases.find(function(a) {
        return a.utmValue === "fbclid"
    });
    if (utm != "ecom" && urlParams.has("fbclid")) {
        if (fbclidCase) {
            var mediums = fbclidCase.mediums;
            for (var j = 0; j < mediums.length; j++) {
                var medium = mediums[j];
                setCookie(medium.cookieName, medium.cookieValue, medium.expiresin)
            }
            for (var k = 0; k < cookiesToDelete.length; k++) {
                var cookieName = cookiesToDelete[k];
                if (cookieName !== medium.cookieName && getCookie(cookieName) !== "") {
                    setCookie(cookieName, "", -1)
                }
            }
        }
    } else {
        for (var i = 0; i < utmCases.length; i++) {
            var utmCase = utmCases[i];
            var utmValue = utmCase.utmValue;
            var mediums = utmCase.mediums;
            if (utm === utmValue) {
                for (var j = 0; j < mediums.length; j++) {
                    var medium = mediums[j];
                    if (!hasMedium || (hasMedium && medium.medium === utmm)) {
                        setCookie(medium.cookieName, medium.cookieValue, medium.expiresin);
                        for (var k = 0; k < cookiesToDelete.length; k++) {
                            var cookieName = cookiesToDelete[k];
                            if (cookieName !== medium.cookieName && getCookie(cookieName) !== "") {
                                setCookie(cookieName, "", -1)
                            }
                        }
                        break
                    }
                }
                break
            }
        }
    }
} else {
    alert("Trình duyệt của bạn đã chặn cookies, vui lòng bỏ chặn cookies để tiếp tục mua sắm.")
};